---
title:  Вычислительные графы
created: 2025-11-16
tags:
links:
---
**Определение:** *Вычислительный граф* - репрезентация процесса вычисления математического выражения, в котором вычисление разбито в отдельные операции, которые представлены как вершина графа.

Рассмотрим вычисление функции $L(a,b,c)=c(a+2b)$. Если мы сделаем компоненты умножения и сложения явными и добавим им имя для промежуточных выводов, то серия результатов будет:
$$
\begin{array} \\
d&=&2*b \\
e&=&a+d \\
L&=&c*e
\end{array}
$$
Теперь мы можем представить это в виде графа с вершинами для каждой операции и направленными ребрами, показывающие выход операции во вход следующей.

### Обратное дифференцирование на вычислительных графах

Важность вычислительных графов приходит от обратного прохода, который используется для вычисления производных, которые нужны для обновления весов. Рассмотрим пример вычисления производной выходной функции $L$ по каждой переменной 

Обратное дифференцирования использует [[Основые правила дифференцирования#^63bc1e|правило цепей]] 

Идея обратного дифференцирования заключается в обратном проходе градиентов из итоговой вершины во все вершины графа.

![[Pasted image 20251116124053.png]]

На рисунке выше показана часть обратного вычисления производной по $e$. Каждая вершина принимает восходящий градиент, который передается от родительской вершины справа и для каждого из входов вычисляет локальный градиент и затем использует правило цепей, чтобы вычислить нисходящий градиент, передаваемый следующему предыдущему узлу.

![[Pasted image 20251116125253.png]]

На рисунке изображено обратное дифференцирование функции, рассматриваемой в начале.