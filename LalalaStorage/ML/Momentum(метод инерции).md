---
title: Momentum(метод инерции)
created: 2025-08-08
tags:
  - ml
  - optimization
links:
  - "[[Градиентный спуск и оценивание градиента]]"
---
**Проблема, решаемая методом:** Сильное изменение направления антиградиента от шага к шагу. Например, если линии уровня функционала сильно вытянуты, то из-за ортогональности градиента линиям уровня он будет менять направление на почти противоположное на каждом шаге. Из-за этого потребуется много итераций.
**Решение:** Усреднение векторов антиградиента с нескольких предыдущих шагов при помощи введения *вектора инерции*:
$$\begin{array} \\
 h_{0}=0 \\
h_{k} = \alpha h_{k-1} + \eta_{k}\nabla_{w}Q(w^{(k-1)}).

\end{array}$$
, где $\alpha$ - параметр метода, определяющей скорость затухания градиентов с предыдущих шагов. Также вместо вектора градиента может быть использована его аппроксимация.
Шаг градиентного спуска:
$$w^{(k)}= w^{(k-1)}-h_{k}$$
**Замечание:** Если по какой-то координате градиент постоянно меняет знак, то в результате усреднения градиентов в векторе инерции эта координата окажется близкой к нулю. Если же по координате знак градиента всегда одинаковый, то величина соответствующей координаты в векторе инерции будет большой, и мы будем делать большие шаги в соответствующем направлении.