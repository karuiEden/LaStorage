---
title: Извлечение фонетических и речевых признаков
created: 2025-12-26
tags:
  - nlp
links:
---
## Звуки речи и фонетическая транскрипция

Буква, подобная "a" или "п" уже является полезной моделью звуков человеческой речи. Тем не менее, полезно представлять звуки несколько более абстрактно. Будем представлять произношение слова как последовательность фонем, которые являются звуками речи, каждый из которых представлен символами, адаптированных из латинского алфавита.

Стандартное фонетическое представление для транскрипции мировых языков это *Международный Фонетический Алфавит*, постоянно развивающийся стандарт, впервые разработанный в 1888 году. Но будем рассматривать фонемы с помощью *APRAbet* простого фонетического алфавита, который удобно использует символы ASCII для представления американского английского подмножества IPA.

![[Pasted image 20251226183000.png]]

Большинство IPA и APRAbet символов эквивалентны известным буквам латинским буквам. Итак, например, APRAbet фонема \[p\] представляет согласный звук в начале *puma, platypus* и *plantain*, середины *leopard* и конец *antelope*. В общем, однако, соответствие между английской орфографии и фонемами относительно непрозрачно, одна и та же буква может представлять совершенно разные звуки в разных контекстах. Английская буква "c"  соответствует фонеме \[k\] в слове cougar \[ k  uw g axr\], но фонеме \[s\] в слове cell \[s eh l\]. Помимо c и k, фонема \[k\] может встречаться как часть "x" (fox \[f aa k s\]), как "ck" (jackal \[jh a k el\]) и как cc (raccoon \[r ae k uw n\]). Многие другие языки, например, испанский, гораздо более прозрачны в своем соответствии звуков и орфографии, чем английский.

Существует множество фонетических ресурсов для фонетической транскрипции. Онлайн-словари произношения представляют транскрипции слов. Словарь произношения LDC распространяет лексиконы произношения для египетского, арабского, голландского, английского, немецкого, японского, корейского, китайского и испанского языков. Для английского языка словарь CELEX содержит произношения для $160. 595$ словоформ, включая информацию о слогоделении, ударении, морфологии и частях речи. Открытый словарь произношения CMU содержит произношения примерно для $134.000$ словоформ, в то же время как подробный словарь UNISYN, содержащий $110.000$ слов и свободно доступный для исследовательских целей, предоставляет информацию о слогоделении, ударении, а также произношение для десятка диалектов английского языка.

Еще одним полезным ресурсом является фонетически аннотированный корпус, в котором набор волновых форм вручную размечен соответствующей строкой фонем. Корпус TIMIT первоначальный проект Texas Instruments, MIT и SRI, представляет собой корпус из 6300 прочитанных предложений, по 10 предложений от 30 дикторов. 6300 предложений были отобраны из набора из 2342 предложений, некоторые из которых были выбраны для наличия определенных диалектных шибболетов, а другие - для максимального охвата фонетических дифонов. Каждое предложение в корпусе было фонетически размеченно вручную, последовательность фонем была автоматически выровнена с волновым файлом предложения, а затем автоматические границы фонем были вручную скорректированы.  В результате получается транскрипция, выровненная по времени: транскрипция, в которой каждая фонема связана со временем начала и окончания в волновой форме.

![[Pasted image 20251226185713.png]]

Фонетически аннотированный корпус проекта Switchboard Transcription Project состоит из 3.5 часов предложений, извлеченных из корпуса Switchboard вместе с транскрипциями, выровненными по времени на уровне слогов.
![[Pasted image 20251226190140.png]]

Корпус Buckeye - это фонетически транскрибированный корпус спонтанной американской речи, содержащей около $300.000$ слов от $40$ говорящих. Фонетически транскрибированные корпуса доступны для других языков, включая Кильский корпус немецкого языка и корпус китайского языка, транскрибированный Китайской академии социальных наук. 

## Артикуляционная фонетика

**Определение:** *Артикуляционная фонетика* - это наука, изучающая, как эти звуки произносятся различными артикуляционными фонетическими органами в полости рта, горле и носу, изменяя поток воздуха из легких.

### Голосовые органы

На рисунке ниже показаны органы речи. Звук образуется за счет быстрого движения воздуха. Большинство звуков в разговорной речи человек производит, выдыхая воздух из легких через трахею, а затем через рот или нос. Проходя через трахею, воздух проходит через гортань, обычно называемому адамовым яблоком или голосовым аппаратом. Гортань содержит две небольшие складки мышц, голосовые связки, которые могут сближаться или расходиться. Пространство между этими двумя складками называется голосовой щелью. Если складки расположены близко друг к другу, они будут вибрировать при прохождении воздуха через них; если они расположены далеко друг от друга, они не будут вибрировать. Звуки, произносимые при сомкнутых и вибрирующих голосовых связках, называются звонкими, звуки, произносимые без этой вибрации голосовых связок, называются глухими. К звонким звукам относятся \[b\], \[d\], \[g\], \[v\], \[z\], и все англиские гласные. Глухие звуки включают \[p\], \[t\], \[k\], \[f\], \[s\], и другие.

![[Pasted image 20251226194214.png]]

Область над трахеей называется голосовым трактом, она состоит из ротового тракта и носового тракта. После выхода из трахеи воздух может выходить из тела через рот или нос. Большинство звуков образуется при прохождении воздуха через рот. Звуки, образующиеся через нос, называются носовыми звуками, и используют как ротовой, так и носовой тракты в качестве резонирующих полостей. 

Звуки делятся на два основных класса: *согласные* и *гласные*. Оба вида звуков образуются движением воздуха через рот, горло или нос. Согласные образуются путем ограничения или блокировки воздушного потока каким-либо образом и могут быть звонкими или глухими. Гласные имеют меньше препятствий, обычно звонкие и, как правило, громче и дольше звучат, чем согласные. Техническое употребление этих терминов во многом похоже на общепринятое употребление; \[p\], \[b\], \[t\], \[d\], \[k\], \[g\], \[f\], \[v\], \[s\], \[z\], \[r\], \[l\] и т.д. - согласные; \[aa\], \[ae\], \[ao\], \[ih\], \[aw\], \[ow\], \[uw\] и т.д. - гласные. Полугласные (такие как \[y\], \[w\]) обладают некоторыми свойствами обоих типов звуков; Они звучат как гласные, но они короткие и менее слоговые, чем согласные.

### Согласные: место артикуляции

Поскольку согласные получаются ограничением воздушного потока, то их можно разбить по классам в зависимости от точки максимального ограничения, *места артикуляции*. 

![[Pasted image 20251226203649.png]]

- *Губные согласные*: согласные, основное сужение которых образуется при смыкании губ, имеют губное место артикуляции. Также существуют *губно-зубные* согласные, которые образуются путем прижимания нижней губы к верхнему ряду зубов и пропускания воздуха через пространство между верхними зубами.
- *Зубные звуки*: звуки, которые образуются при прижатии языка к зубам, называются зубными звуками. Основными зубными звуками в английском языке являются \[th\] и \[dh\].
- *Альвеолярный*: Альвеолярный гребень - это часть нёба, расположенная непосредственно за альвеолярными верхними зубами.
- *Палатальный звук*: Верхняя часть ротовой полости резко поднимается от задней части альвеолярного отростка. Палато-альвеолярные звуки \[sh\], \[ch\], \[zh\] и \[jh\].
- *Велярный звук*: мягкое небо, или небо, представляет собой подвижную мышечную складку в самой задней части нёба. Звуки \[k\], \[g\] и \[n\] образуются путем прижимания задней части языка к мягкому небу.
- *Гортанный звук*: Гортанная смычка \[q\] образуется путем закрытия голосовой щели.
### Согласные: способ артикуляции

Согласные звуки также различаются способом ограничения воздушного потока, например, полной остановкой потока воздуха или частичной блокировкой. Эта особенность называется *способом артикуляции согласного звука*. Сочетание места и способа артикуляции обычно достаточно для однозначной идентификации согласного звука. Ниже приведены основные способы артикуляции английских согласных:
- *Взрывные согласные*: согласный звук, при произнесении которого поток воздуха полностью блокируется на короткое время. За блокировкой следует взрывной звук, когда воздух выходит. Период блокировки называется *смыканием*, а *взрыв* - высвобождением. В английском есть звонкие взрывные согласные, такие как \[b\], \[d\], \[g\], а также глухие взрывные согласные, такие как \[p\], \[t\], \[k\]. 
- *Носовые согласные*: носовой звук \[m\], \[n\], \[ng\] образуется путем опускания мягкого неба и пропускания воздуха через носовую полость.
- *Фрикативные согласные*: при произнесении фрикативных согласных звуков поток сужается, но не прекращается полностью. Турбулентный поток воздуха, возникающий в результате сужения, производит характерный "шипящий" звук. Английские губно-зубные фрикативные звуки \[f\] и \[v\] образуются путем сжимания нижней губы к верхним зубам, что обеспечивает ограниченный поток воздуха между верхними зубами. Зубные фрикативные звуки \[th\] и \[dh\] позволяют воздуху обтекать язык между зубами. Альвеолярные фрикативные звуки \[s\] и \[z\] образуются при прижатии языка к альвеолярному гребню, выталкивая воздух через край зубов. В палато-альвеолярных фрикативных звуках \[sh\] и \[zh\] язык находится в задней части альвеолярного гребня, выталкивая через бороздку, образованную в языке. Фрикативные согласные с более высоким тоном называют *сибилянтами*. Взрывные согласные, за которыми следуют фрикативные согласные, называются *аффрикатами*; к ним относятся английские \[ch\] и \[jh\].
- *Аппроксимантные согласные*: при аппроксимантах два артикулятора расположены достаточно близко, но недостаточно близко, чтобы вызвать турбулентный поток воздуха. В английском \[y\] язык движется достаточно близко к нёбу, но недостаточно близко, чтобы вызвать турбулентность, характерную для фрикативного звука. В английском \[w\] задняя часть языка приближается к мягкому небу. Американский \[r\] может образовываться как минимум двумя способами: только кончиком языка, вытянутым и близким к нёбу, или всем языком, собранным у нёба. \[l\] образуется кончиком языка, прижатым к альвеолярному отростку или зубам, при этом одна или обе стороны языка опущены, чтобы воздух мог обтекать его. \[l\] называется *боковым звуком* из-за опускания боковых сторон языка.
- *Хлопающие согласные*: хлопанье \[dx\] - это быстрое движение языка по альвеолярному отростку. Хлопающая согласная в середине слова lotus (\[l ow dx ax s]) в большинстве диалектов американского английского.

### Гласные 

Подобно согласным, гласные можно охарактеризовать положением артикуляционных органов в момент их произнесения. Три наиболее важных параметра для гласных - это так называемая *высота гласного звука*, которая приблизительно коррелирует с высотой самой высокой части языка, *переднее* или *заднее* положение гласного звука, указывающее, находится ли эта высокая точка перед или за ротовой полостью, и *округлая ли форма губ*.

![[Pasted image 20251226214605.png]]

Например, в гласном звуке \[iy] самая высокая часть языка находится в передней части рта. В гласном звуке \[uw], напротив, самая высокая точка языка расположена в задней части рта. Гласные звуки, в которых язык поднят в переднюю часть рта, называются *передними гласными*; те, в которых язык поднят в заднюю часть рта, называются *задними гласными*. Обратите внимание, что хотя и \[ih], \[eh] являются передними гласными, язык выше в случае \[ih], чем в случае \[eh]. Гласные звуки, в которых самая высокая точка языка сравнительно высока, называются *высокими гласными*; гласные звуки со средними или низкими значениями максимальной высоты языка называются *средними* или *низкими* гласными соответственно.

![[Pasted image 20251226215215.png]]

На рисунке выше показана схематичная характеристика высоты различных гласных звуков. Она схемотична, потому что абстрактное свойство "высота" лишь приблизительно коррелирует с фактическим положением языка; на самом деле это более точное отражение акустических фактов. Обратите внимание, что на диаграмме представлены 2 типа гласных: те, в которых высота языка представлена точкой, и те, в которых она представлена траекторией. Гласный звук, в котором положение языка заметно меняется во время произнесения гласного, называется *дифтонгом*. Английский особенно богат дифтонгами.

Вторым важным артикуляционным параметром для гласных звуков является форма губ. Некоторые гласные произносятся с округленными губами. К таким округленным гласным относятся \[uw], \[ao] и \[ow].

### Слоги

Согласные и гласные звуки объединяются, образуя слог. *Слог* - это звук, похожий на гласный, вместе с некоторыми окружающими согласными, которые наиболее тесно с ним связаны. Слово "dog" имеет один слог, \[d aa g]; слово "catnip" имеет два слога, \[k ae t] и \[n ih p]. Назовем гласный звук в ядре слога *ядром*. Начальные согласные, если таковые имеются, называются *началом*. Начало слога, содержащее более одного согласного, называется *сложным началом*. *Кода* - это необязательное согласное или последовательность согласных, следующих за ядром. Таким образом, \[d] - это начало "dog", а \[g] - это кода. Рифма - это ядро плюс кода.

![[Pasted image 20251226230630.png]]

Задача автоматического разбиения на слоги называется *слогоделением*. Структура слога тесно связана с фонотактикой языка. Термин *"фонотактика"* означает ограничения, на которые фонемы могут следовать друг за другом в языке. Например, в английском языке существуют строгие ограничения на то, какие согласные могут появляться вместе в начале слова; последовательность \[zdr], например, не может быть допустимым началом. Фонотактику можно представить языковой моделью или конечно-состоятельной моделью последовательностей фонем.

## Просодия

**Определение:** *Просодия* - это наука, изучающая интонационные и ритмические аспекты языка, в частности, использования основной частоты *F0*, *энергии* и *длительности* для передачи прагматических, аффективных или межличностных смыслов. *Энергию* можно рассматривать как громкость, а *F0* как частоту издаваемого звука, которое мы слышим как высоту тона высказывания. Просодия может использоваться для обозначения структуры дискурса, например, границы между утверждениями и вопросами или способа структурирования разговора. Просодия используется для обозначения значимости определенного слова или фразы. Просодия широко используется для паралингвистических функций, таких как передача аффективных значений, например, счастья, удивления или гнева. И просодия играет важную роль в управлении очередностью реплик в разговоре.

### Просодическая выразительность: ударение, акцент и шва.

В естественном произношении американского английского некоторые слова звучат более выразительно, чем другие, и определенные слоги в этих словах также более выразительны, чем другие. Под *выразительностью* подразумевается, что эти слова или слоги воспринимаются слушателем более отчетливо. Говорящие делают слово или слог более выразительным в английском языке, произнося его громче, медленнее или изменяя F0 во время слова, делая его выше или более изменчивым.

- *Ударение*: Обозначим с помощью лингвистического маркера, называемого тональным ударением. Слова или слоги, которые выделяются, считаются имеющим тональным ударением. Таким образом, это высказывание может быть произнесено с акцентированием подчеркнутых слов.

![[Pasted image 20251226234021.png]]

- *Лексическое ударение*: Слоги, имеющие тональное ударение, называются *ударными слогами*. Не каждый слог может быть ударным: тональное ударение должно быть на слоге, имеющем лексическое ударение. *Лексическое ударение* - это свойство произношения слова в словарях; слог с лексическим ударением будет громче или длиннее, если слово ударное. 

![[Pasted image 20251226234345.png]]

Ударение обозначается в словарях.
- *Редуцированные гласные и шва*: Безударные гласные могут быть ослаблены еще сильнее до редуктивных гласных, наиболее распространенным из которых является *шва* \[ax]. В редуцированной гласной артикуляционный жест не такой, как в случае с полной гласной. Не все безударные гласные редуцируются; любая гласная, и дифтонги в частности, могут сохранять своё полное качество даже в безударной позиции. 

В заключении, существует *континуум* просодической выразительности, для обозначения которого часто полезно использовать такие уровни, как акцентированный, ударный, полный гласный и редуцированный гласный.

### Структура просодии

Устные предложения имеют просодическую структуру: некоторые слова, кажется, естественным образом группируются вместе, в то время как между некоторыми словами наблюдается заметный разрыв или диссонанс. Просодическая структура часто описывается с помощью *просодической фразировки*, то есть высказывание имеет просодическую фразовую структуру аналогично тому, как оно имеет синтактическую фразовую структуру.  Например, предложение "I wanted to go to London, but could only get tickets for France" имеет две основные *интонационные фразы*, граница которых находится у запятой. Кроме того, в первой фразе, кажется, есть еще один набор менее значительных границ просодических фраз (часто называемых *промежуточными фразами*), которые разделяют слова как "I wanted | to go | to London". Такие интонационные фразы часто коррелируют с составляющими синтаксической структуры.

Автоматическое предсказание просодических границ может быть важным для таких задач, как TTS. Современные модели, которые используют модели последовательностей, которые принимают на вход либо необработанный текст, либо текст, аннотированный такими признаками, как деревья разбора, и принимают решение о разрыве/отсутствии разрыва на границе каждого слова. Их можно обучать на данных, размеченных по просодической структуре.

### Интонация

Два высказывания с одинаковой вероятностью и фразировкой могут различаться просодически, имея разную *интонацию*. *Интонация высказывания* - это повышение и понижение его основной частоты (F0) во времени. Очень наглядный пример интонации - разница между утверждениями и вопросами тип "да-нет" в английском языке. Одни и те же слова можно произнести с повышением F0 в конце, чтобы обозначить вопрос типа "да-нет":

![[Pasted image 20251227001226.png]]

или понижением F0, чтобы обозначить повествовательную интонацию:

![[Pasted image 20251227001309.png]]

В языках широко используется интонация для выражения смысла. В английском языке, например, помимо хорошо известного подъема для вопросов типа "да-нет", фраза, содержащая список существительных, разделенных запятыми, часто имеет короткий подъем, называемый *подъемом продолжения*, после каждого существительного. Другие примеры включают характерные английские контуры для выражения противоречия и выражения удивления. 

#### Связывание значимости и интонации

Ударения по высоте тона бывают разных видов, связанных с интонацией; высокие ударения, например, выполняют иные функции, чем низкие ударения. Существует множество типологий классов ударений в разных языках. Одна из таких типологий является частью теории интонации ToBl (индексы тона и разрыва). Каждое слово в ToBl может быть связано с одним из пяти типов ударений по высоте тона, показанных ниже. Каждое высказывание в ToBl состоит из последовательности интонационных фраз, каждая из которых заканчивается одним из четырех граничных тонов, показанных ниже. Существуют версии ToBl для многих языков.

![[Pasted image 20251227002326.png]]

## Акустическая фонетика и сигналы

### Волны

Акустический анализ основан на функциях синуса и косинуса. На рисунке ниже показан график синусоиды, в частности функции:
$$
y= A\cdot \sin(2\pi ft),
$$
где $A$ - *амплитуда*, $f$ - *частота*.

![[Pasted image 20251227115545.png]]

### Речевые звуковые волны

Входной сигнал для распознавателя речи, подобно входному сигналу для человеческого уха, представляет собой сложную последовательность изменений давления воздуха. Эти изменения давления воздуха, очевидно, исходят от говорящего и вызваны специфическим способом прохождения воздуха через голосовую щель и выхода через ротовую или носовую полости. Мы представляем звуковые волны, отображая изменение давления воздуха во времени. Одна из метафор, которая иногда помогает понять эти графики, - это метафора вертикальной пластины, блокирующей волны давления воздуха. График измеряет величину *сжатия*(компрессии) или *разрежения* молекул воздуха у этой пластины. На рисунке ниже показан короткий фрагмент волновой формы, взятый из корпуса телефонной речи Switchboard, гласного звука \[iy] от человека, произносящего "she just had a baby".

![[Pasted image 20251227120425.png]]

Первый шаг в цифровизации звуковой волны, как на рисунке выше, чтобы конвертировать аналоговые представления в цифровой сигнал. *Аналого-цифровое преобразование* состоит из двух этапов: *дискретизации* и *квантования*. Для дискретизации сигнала измеряется его амплитуда в определенный момент времени; частота дискретизации - это количество отсчетов, берущихся в секунду. Для точного измерения волны необходимо иметь как минимум два отсчета в каждом цикле; один измеряющий положительную часть волны, и один, измеряющий отрицательную часть. Более двух отсчетов за цикл повышают точность измерения амплитуды, но меньшее количество отсчетов приводит к тому, что частота волны полностью теряется. Таким образом, волна с максимальной частотой, которую можно измерить, - это волна, частота которой составляет половину частоты дискретизации. Эта максимальная частота для данной частоты дискретизации называется *частотой Найквиста*. Большая часть информации в человеческой речи находится в частотах Найквиста ниже $10.000$ Гц; таким образом, для полной точности потребовалось бы частота дискретизации $20.000$ Гц. Но телефонная речь фильтруется коммутационной сетью, и телефоны передают только частоты ниже $4.000$ Гц. Таким образом, частота дискретизации $8.000$ Гц достаточна для речи в телефонном диапазоне, такой как корпус Switchboard, в то время как для речи, передаваемой через микрофон, часто используется частота дискретизации $16.000$ Гц. 

Даже частота дискретизации $8.000$ Гц требует $8.000$ измерений амплитуды на каждую секунду речи, поэтому важно эффективно хранить измерения амплитуды. Обычно они хранятся в виде целых чисел, либо 8-битных, либо 16-битных. Этот процесс представления действительных чисел в виде целых чисел называется *квантованием*, поскольку разница между двумя целыми числами действует как минимальная гранулярность, и все значения, которые ближе друг к другу, чем этот размер кванта, представляются одинаково.

После квантования данные сохраняются в различных форматах. Одним из параметров этих форматов является частота дискретизации и размер выборки; телефонная речь часто дискретизируется с частотой 8 кГц и хранится в виде 8-битных выборок, а данные с микрофона часто дискретизируются с частотой 16 кГц и хранятся в виде 16-битных выборок. Другим параметром является количество *каналов*. Для стереоданных или для разговоров двух сторон мы можем хранить оба канала в одном файле или в отдельных файлах. Последний параметр - это хранение отдельных выборок - линейная или сжатая. Одним из распространённых форматов сжатия, используемых для телефонной речи, является $\mu$-закон. Идея алгоритмов логарифмического сжатия, таких как $\mu$-закон, заключается в том, что человеческий слух более чувствителен к малым интенсивностям, чем к большим; логарифм представляет малые значения с большей точностью за счет большей ошибки при больших значениях. Линейные значения обычно называются линейными значениями *PCM*(PCM расшифровывается как импульсно-кодовая модуляция, но это неважно). Вот уравнение для сжатия линейного значения выборки PCM $x$ до 8-битного $\mu$-закона(где $\mu=255$ для 8 бит):
$$
F(x) = \frac{\mathrm{sgn}(x)\log(1+\mu |x|)}{\log(1+\mu)}\quad -1<x<1
$$
Существует ряд стандартных форматов файлов для хранения полученного оцифрованного файла wave, например, формат .wav от Microsoft или AIFF от Apple, все из которых имеют специальные заголовки; также используются простые файлы raw без заголовков. Например, формат .wav является подмножеством формата RIFF от Microsoft для мультимедийных файлов; RIFF - это общий формат, который может представлять собой серию вложенных блоков данных и управляющей информации. На рисунке ниже показан простой .wav.

![[Pasted image 20251227131203.png]]

### Частота и амплитуда; высота тона и громкость.

Звуковые волны, как и все волны, могут быть описаны с помощью частоты, амплитуды и других характеристик. В звуковых волнах эти параметры не так просто измерить, как в случае синусоидальных волн. Рассмотрим частоту на волне выше, хотя это и не совсем синусоида, волна тем не менее периодична, повторяясь 10 раз за 38.75 миллисекунд, показанных на рисунке. Таким образом, частота будет равна 258 Гц. 

Откуда берется эта периодическая волна частотой 258 Гц? Она возникает из-за скорости колебаний головых связок; поскольку форма волны на рисунке волны соответствует гласному звуку \[iy], он звонкий. Когда голосовые связки открыты, воздух выталкивается через легкие, создавая область высокого давления. Когда связки закрыты, давления со стороны легких нет. Таким образом, когда голосовые связки вибрируют, мы ожидаем увидеть регулярные пики амплитуды, подобные тем, что были выше, причем каждый основной пик соответствует открытию голосовых связок. Частота колебаний голосовых связок, или частота комплексной волны, называется *основной частотой* волновой формы, часто обозначаемой аббревиатурой F0. Мы можем построить график F0 во времени на графике изменения *высоты тона*. Ниже показана дорожка изменения высоты тона, обратите внимание на повышение F0 в конце вопроса.

![[Pasted image 20251227133110.png]]

Вертикальная ось на рисунке синусоиды, измеряет величину изменения давления воздуха; *давление* - это сила на единицу площади, измеряемая в Паскалях. Высокое значение на вертикальной оси указывает на то, что в данный момент времени давление воздуха выше, нулевое значение означает нормальное давление воздуха. а отрицательное значение означает, что давление воздуха ниже нормы. В дополнение к этому значению амплитуды в любой момент времени нам также часто необходимо знать среднюю амплитуду за некоторый временной промежуток, чтобы получить представление о том, насколько велико среднее смещение давления воздуха. Но мы не можем просто взять среднее значение амплитуды за определенный промежуток времени; положительные и отрицательные значения взаимно компенсируются, оставляя нам число, близкое к нулю. Вместо этого мы обычно используем *среднеквадратичную амплитуду (RMS)*, которая возводит каждое число в квадрат перед усреднением, а затем в конце извлекает квадратный корень.
$$
\mathrm{RMS \ amplitude}_{i=1}^{N}= \sqrt{ \frac{1}{N} \sum_{i=1}^{N}x_{i}^{2} }
$$
*Мощность* сигнала связана с квадратом амплитуды. Если число отсчетов звука равно $N$, то мощность равна:
$$
\mathrm{Power} = \frac{1}{N}\sum_{i=1}^{N}x_{i}^{2}
$$

Вместо мощности чаще говорят об интенсивности звука, которая нормирует мощность относительно порога слуха человека и измеряется в дБ. Если $P_{0}$ - пороговое давление слуха $=2\cdot10^{-5}$ Па, то интенсивность определяется:
$$
\mathrm{Intensity} = 10\log_{10} \frac{1}{NP_{0}} \sum_{i=1}^{N}x_{i}^{2} 
$$
На рисунке ниже показан график интенсивности для предложения "Is it a long movie?" из корпуса CallHome, который также показан ниже графика волновой формы.

![[Pasted image 20251227134851.png]]

Два важных перцептивных свойства, *высота тона* и *громкость*, связаны с частотой и интенсивностью. *Высота тона звука* - это ментальное ощущение, или перцептивный коррелят, основной частоты; в общем, если звук имеет более высокую основную частоту, мы воспринимаем его как имеющий более высокий тон. Мы говорим "в общем", потому что зависимость нелинейна, так как человеческих слух имеет разную остроту для разных частот. Грубо говоря, восприятие высоты тона человека наиболее точно в диапазоне от 100 Гц до 1000 Гц, и в этом диапазоне высота тона линейно коррелирует с частотой. Человеческий слух менее точно представляет частоты выше 1000 Гц, и выше этого диапазона высота тона коррелирует с частотой логарифмически. Логарифмическое представление означает, что различия между высокими частотами сжимаются и, следовательно, воспринимаются не так точно. Существуют различно психоакустические модели шкал восприятия высоты тона. Одной из распространенных моделей является *мел*-шкала. *Мел* - это единица высоты тона, определенная таким образом, что пары звуков, которые воспринимаются как равноудаленные по высоте, разделены равным числом мел. Частоту мела $m$ можно вычислить из исходной акустической частоты следующим образом:
$$
m= 1127\ln\left( 1 + \frac{f}{700} \right)
$$
*Громкость* звука является перцептивным коррелятом его мощности. Таким образом, звуки с более высокой амплитудой воспринимаются как более громкие, но опять же, эта зависимость нелинейна.

Во-первых, когда определяли закон $\mu$-закон сжатия, у людей более высокое разрешение в диапазоне низкой мощности; ухо более чувствительно к небольшим различиям в мощности. Во-вторых, оказывается, что существует сложная взаимосвязь между мощностью, частотой и воспринимаемой громкостью; звуки в определенных частотных диапазонах воспринимаются как более громкие, чем звуки в других частотных диапазонах.

Существует множество алгоритмов для автоматического извлечения F0. В некотором смысле, это называется алгоритмами *извлечения высоты тона*. Например, метод автокорреляции при извлечении высоты тона коррелирует сигнал сам с собой при различных смещениях. Смещение, дающее наибольшую корреляцию, определяет период сигнала. Существует множество общедоступных наборов инструментов для извлечения высоты тона; например, расширенный трекер высоты тона на основе автокорреляции представляется в Praat.

### Интерпретация телефонных сигналов по волновой форме

Многое можно узнать, визуально изучив форму волны. Например, гласные звуки довольно легко заметить, так как они звонкие; еще одно свойство гласных звуков заключается в том, что они, как правило, долгие и относительно громкие. Длительность во времени проявляется непосредственно на оси $X$, а громкость связана с (квадратом) амплитуды на оси $Y$. На рисунке ниже показана форма волны короткого предложения "she just had a baby". Мы обозначили эту форму волны словами и фонемами. Обратите внимание, что каждая из шести гласных имеет регулярные пики амплитуды, указывающие на звонкость.

![[Pasted image 20251227150723.png]]

Для взрывного согласного, который состоит из смыкания с последующим размыканием, мы можем часто наблюдать период тишины или почти тишины, за которым следует небольшой всплеск амплитуды. Мы можем увидеть это для обоих \[b] в слове baby. Другой фонем, который часто довольно легко узнаваем по форме волны, - это фрикативный звук. Получающиеся шипящие звуки имеют шумную, нерегулярную форму волны. Это можно частично увидеть на рисунке выше. Это еще яснее на рисунке ниже.

![[Pasted image 20251227151050.png]]

### Спектр и частотная область

Хотя некоторые общие фонетические характеристики могут быть интерпретированы непосредственно из формы волны, большинство вычислительных приложений, таких как распознавание речи, основаны на другом представлении звука с точки зрения его составляющих частот. Суть *анализа Фурье* заключается в том, что каждая комплексная волна может быть представлена как сумма множества синусоидальных волн разных частот. Рассмотрим форму волны на рисунке ниже. Это форма волны была создана путем суммирования двух синусоидальных волн, одна с частотой 10 Гц. а другая с частотой 100 Гц.

![[Pasted image 20251227151806.png]]

Мы можем представить эти две составляющие частоты с помощью *спектра*. *Спектр сигнала* - это представление каждой из его частотных составляющих и их амплитуд. На рисунке ниже показан спектр, представленный на рисунке выше. Частота в Гц отложена по оси $x$, а амплитуда -  по оси $y$. Обратите внимание на два пика на рисунке: один на частоте 10 Гц, а другой на частоте 100 Гц. Таким образом, спектр является альтернативным представлением исходной формы волны, и мы используем спектр как инструмент для изучения составляющих частот звуковой волны в определенный момент времени. 
Теперь рассмотрим частотные составляющие речевой волны. На следующем рисунке ниже показана часть волновой формы для гласного \[ae] слова had, вырезанная из предложения, рассмотренного раннее. Обратите внимание, что на рисунке присутствует сложная волна, которая повторяется около десяти раз; Но существует также меньшая повторяющаяся волна, которая повторяется четыре раза для каждого большого паттерна. Сложная волна имеет частоту около 234 Гц.

![[Pasted image 20251227152752.png]]


![[Pasted image 20251227152758.png]]

На оси $x$ спектра отображается частота, а на оси $y$ - некоторая мера величины каждой частотной составляющей. Таким образом, на рисунке ниже показаны значимые частотные составляющие примерно на частотах 930 Гц, 1860 Гц и 3020 Гц, а также множество других частотных составляющие - это именно то, что мы заметили во временной области, рассматривая волну на рисунке выше.

Почему спектр полезен? Оказывается, эти спектральные пики, которые легко видны в спектре, характерны для разных фонем; фонемы имеют характерные спектральные "сигнатуры". Подобно тому, как химические элементы испускают разные длины волн света при горении, что позволяет нам обнаруживать элементы в звездах, глядя на спектр волновой формы. Это использование спектральной информации имеет важное значение как для распознавания речи человеком, так и для распознавания речи машиной. В человеческом слухе функция улитки, или внутреннего уха, заключается в вычислении спектра входящей волновой формы.

Аналогично, акустические характеристики, используемые в распознавании речи, представляют собой спектральные представления.

Рассмотрим спектр различных гласных звуков. Поскольку некоторые гласные меняются со временем, мы будем использовать другой тип графика, называемый *спектрограммой*. В то время как спектр показывает частотные компоненты волны в определенный момент времени, спектрограмма - это способ визуализации того, как различные частоты, составляющие форму волны, изменяются со временем. Ось $x$ показывает время, как и для формы волны. но ось $y$ теперь показывает частоты в герцах. Темнота точки на спектрограмме соответствует амплитуде частотной компоненты. Очень темные точки имеют высокую амплитуду, светлые точки - низкую амплитуду. Таким образом, спектрограмма - это полезный способ визуализации трех измерений. На рисунке ниже показаны спектрограммы трех гласных звуков американского английского. Обратите внимание, что каждая гласная имеет набор темных полос в различных частотных диапазонах, немного отличающихся для каждой гласной. Каждый из них представляет собой тот же самый спектральный пик, который видели раннее.

![[Pasted image 20251227154747.png]]

Каждая темная полоса называется *формантой*. Как мы обсудим ниже, форманта - это полоса частот, которая особенно усиливается голосовым трактом. Поскольку разные гласные звуки произносятся голосовым трактом в разных положениях, они будут вызывать разные виды усиления или резонанса. Рассмотрим первые две форманты, называемые F1, F2. Обратите внимание, что F1, темная полоса, ближайшая к низу, находится в разных положениях для трех гласных; Мы можем наблюдать те же форманты в беглой речи, хотя процессы редукции и коартикуляции несколько затрудняют их различение. На рисунке ниже показана спектрограмма фразы "she just had a baby".

![[Pasted image 20251227155653.png]]

Какие конкретные подсказки могут дать спектральные представления для идентификации фонем? Во-первых, поскольку разные гласные имеют свои форманты в характерных местах, спектр может различать гласные друг от друга. Мы видели, что \[ae] в образце звуковой волны имел форманты на частотах 930 Гц, 1860 Гц и 3020 Гц. Рассмотрим гласный \[iy]. Спектр для этого гласного показан на рисунке ниже. Первая форманта \[iy] составляет 540 Гц, что значительно ниже, чем первая форманта для \[ae], а вторая форманта значительно выше, чем вторая форманта для \[ae]. Если вы внимательно посмотрите, вы увидите эти форманты в виде темных полос на рисунке выше через 0.5 секунд.

![[Pasted image 20251227160234.png]]

Расположение первых двух формант играет важную роль в определении идентичности гласных, хотя форманты всё же различаются от говорящего к говорящему. Более высокие форманты, как правило, обусловлены скорее общими характеристиками голосового тракта говорящего, чем отдельными гласными. Форманты также могут использоваться для идентификации носовых звуков, а также плавных звуков.

### Модель источника-фильтра

Почему разные гласные имеют разные спектральные характеристики? Как мы кратко упомянули выше, форманты обусловлены резонансными полостями рта. Модель *источник-фильтр* - это способ объяснить акустику звука, моделируя, как импульсы, создаваемые головой щелью (источник), формируется голосовым трактом(фильтр). 

Давайте посмотрим, как это работает. Всякий раз, когда у нас есть волна, такая как вибрация воздуха, вызванная голосовым импульсом, эта волна также имеет *гармоники*. *Гармоника* - это другая волна, частота которой кратна основной волне. Таким образом, например, вибрация голосовых связок с частотой 115 Гц приводит к гармоникам с частотой 230 Гц. 345 Гц, 460 Гц и так далее. В целом, каждая из этих волн будет слабее, то есть будет иметь гораздо меньшую амплитуду, чем волна на основной частоте.

Однако оказывается, что голосовой тракт действует как своего рода фильтр или усилитель; действительно, любая полость, например, трубка, вызывает усиление волн определенных частот, и затухание других. Этот процесс усиления обусловлен формой полости; определенная форма вызовет резонанс звуков определенной частоты и, следовательно, усиление. Таким образом, изменяя форму полости, мы можем вызвать усиление различных частот. 

Когда мы произносим определенные гласные звуки, мы, по сути, изменяем форму полости голосового тракта, располагая язык и другие артикуляционные органы в определенных позициях. В результате разные гласные звуки вызывают усиление различных гармоник. Таким образом, волна одной и той же основной частоты, проходящая через разные положения голосового тракта, приведет к усилению различных гармоник. 

Результатом этого усиления можно увидеть, рассмотрев взаимосвязь между формой голосового тракта и соответствующим спектром. На рисунке ниже показано положение голосового тракта для трех гласных звуков и типичный результирующий спектр. Форманты - это места в спектре, где голосовой тракт усиливает определенные гармонические частоты.

![[Pasted image 20251227162636.png]]

## Извлечение признаков для распознавания речи: Log Mel Спектр

Те же инструменты, которые мы использовали для анализа акустической фонетики волновых форм, также часто используются в качестве входных данных для алгоритмов обработки речи. Первым шагом в обработке речи часто является преобразование входной волновой формы в последовательность *векторов акустических признаков*, каждый вектор представляет информацию в небольшом временном окне сигнала. Иногда алгоритмы распознавания речи или обработки речи начинаются с волновой формы, в этом случае обработка выполняется с помощью сверточных сетей.

Другие системы начинают с более высокого уровня, с логарифмического мел-спектра. Поэтому в этом разделе представим этот широко используемый вектор признаков: последовательности векторов *логарифмического мел-спектра*. В следующем разделе представим альтернативный вектор, представление *MFCC*. Мы представим эти понятия на относительно высоком уровне.

### Оконная обработка

Из оцифрованного, квантованного представления волновой формы нам необходимо извлечь спектральные признаки из небольшого окна речи, которое характеризует часть конкретной фонемы. Внутри этого небольшого окна мы можем приблизительно считать сигнал *стационарным* (то есть его статистические свойства постоянны в этой области). (В отличие от этого, в общем случае речь является *нестационарным сигналом*, то есть её статистические свойства не постоянны во времени). Мы извлекаем эту приблизительно стационарную часть речи, используя окно, которое не равно нулю внутри области и равно нулю в других местах, пропуская это окно по речевому сигналу и умножая его на входную волновую форму, чтобы получить оконную волновую форму.

Речь, извлеченная из каждого окна, называется *кадром*. Оконная обработка характеризуется тремя параметрами: размером окна или размером кадра окна(его шириной в милли секундой), шагом кадра(также называемой сдвигом или смещением) между последовательными окнами и формой окна.

Для извлечения сигнала мы умножаем значение сигнала в момент времени n, s\[n], на значение окна в момент времени n, w\[n]:
$$
y[n]=w[n]s[n]
$$

![[Pasted image 20251227172447.png]]

Форма окна, изображенная на рисунке выше, прямоугольная; видно, что извлеченный оконный сигнал выглядит точно так же, как и исходный сигнал. Прямоугольное окно, однако, резко обрезает сигнал на своих границах, что создает проблемы при проведении анализа Фурье. По этой причине для создания акустических характеристик мы чаще используем окно *Хэмминга*, которое уменьшает значения сигналов до нуля на границах окна, избегая разрывов. На рисунке выше показаны оба варианта; уравнения следующие:
$$
\text{rectangular}\quad\quad w[n]=\begin{cases}
1\quad0\leq n\leq L-1 \\
0\quad \text{otherwise}
\end{cases}
$$
$$
\text{Hamming} \quad\quad w[n]=\begin{cases}
0.54-0.46\cos\left(  \frac{2\pi n}{L}  \right)\quad &0\leq n\leq L-1 \\
0\quad&\text{otherwise}
\end{cases}
$$

![[Pasted image 20251227174825.png]]

### Дискретное преобразование Фурье

Следующий шаг - извлечение спектральной информации из нашего оконного сигнала; нам необходимо знать, сколько энергии содержит сигнал в разных частотных диапазонах. Инструментом для извлечения спектральной информации для дискретных частотных диапазонов для дискретного по времени сигнала является *дискретное преобразование Фурье* (ДПФ/DFT). Входными данными для DFT являются оконный сигнал $x[n]\dots x[m]$, а выходными данными для каждого из $N$ дискретных частотных диапазонов является комплексное число $X[k]$, представляющее собой величину и фазу этой частотной составляющей в исходном сигнале. Если построить график зависимости величины от частоты, то можно визуализировать спектр. Например, на рисунке ниже показан фрагмент сигнала, обработанный окном Хэмминга длительностью 25 мс, и его спектр, вычисленный с помощью DFT.

![[Pasted image 20251227175753.png]]

Не будем вдаваться в математические подробности DFT, за исключением того, что отметим: анализ Фурье основан на формуле Эйлера, где $j$ - мнимая единица:
$$
e^{ j\theta }=\cos\theta+j\sin\theta
$$
В качестве краткого напоминания DFT определяется следующим образом:
$$
X[k]=\sum_{n=0}^{N-1} x[n]e^{ -j \frac{2\pi}{N}kn }
$$
Распространенным алгоритмом для вычисления DFT является *быстрое преобразование Фурье* или *FFT*. Этот метод реализации DFT очень эффективен, но работает только для значений $N$, являющихся степенями двойки.
### Фильтр Мела и логарифм

Результаты FFT показывают нам энергию в каждом частотном диапазоне. Однако человеческий слух не одинаково чувствителен во всех частотных диапазонах; он менее чувствителен на более высоких частотах. Эта предвзятость в сторону низких частот помогает распознаванию человеком, поскольку информация в низких частотах имеет решающее значение для различения гласных или носовых звуков, в то время как информация в высоких частотах менее важна для успешного распознавания. Моделирование этого свойства человеческого восприятия улучшает производительность распознавания речи аналогичным образом.

Мы реализуем эту интуицию, собирая данные об энергии не одинаково в каждом частотном диапазоне, а в соответствии со шкалой мел, шкалой слуховых частот. *Мел* - это единица высоты тона. Пары звуков, которые воспринимаются как равноудаленные по высоте тона, разделены равным числом мел. Частота мела $m$ может быть вычислена из исходной акустической частоты с помощью логарифмического преобразования:
$$
mel(f)=1127\ln\left( 1 + \frac{f}{700} \right)
$$
Мы реализуем эту идею, создавая набор фильтров, которые собирают энергию из каждой полосы частот, распределённую логарифмически, так что мы получаем очень высокое разрешение на низких частотах и меньшее разрешение на высоких частотах. На рисунке снизу показан пример набора треугольных фильтров, реализующих эту идею, который можно умножить на спектр, чтобы получить мел-спектр:

![[Pasted image 20251227182318.png]]

Наконец, мы берем логарифм каждого значения мел-спектра. Реакция человека на уровень сигнала является логарифмической. Люди менее чувствительны к небольшим различиям в амплитуде при высоких значениях, чем при низких. Кроме того, использование логарифма делает оценки признаков менее чувствительными к изменениям входного сигнала, таким как изменения мощности из-за приближения или удаления рта говорящего от микрофона. Мы называем каждый скалярный выходной сигнал от конкретного фильтра каналом, и поэтому выходной сигнал для каждого входного кадра из банка фильтров представляет собой вектор, скажем, из 80 или 128 каналов, каждый из которых представляет собой логарифм энергии определенной полосы частот.

Прежде чем отправить этот логарифмический вектор *мел-каналов* в нижестоящие слои нейронной сети, речевые системы обычно масштабируют их, чтобы они имели сопоставимые диапазоны. Распространенный тип нормализации заключается в масштабировании входных данных таким образом, чтобы их значения находились в диапазоне от -1 до 1 со средним значением, равным нулю, по всему предварительному обучающему набору.

## MFCC: кепстральный коэффициент частоты Mel

*MFCC (мел-частотные кепстральные коэффициенты)* - это полезное представление формы сигнала MFCC, которое выделяет аспекты сигнала, имеющие значение для обнаружения фонетических единиц. MFCC представляет собой 39-мерный вектор призаков состоящий из:
12 кепстральных коэффициентов, 1 энергетического коэффициентов, 12 дельта-кепстральных коэффициентов, 1 дельта-энергетического коэффициента, 12 двойного дельта-кепстральных коэффициентов, 1 двойного дельта-энергетического коэффициента.

### Кепстр: обратное дискретное преобразование Фурье

Коэффициенты MFCC основаны на *кепстре*. *Кепстр* можно рассматривать как полезный способ разделения источника и фильтра. Вспомним, что речевая волна создается, когда гортанный источник с определенной основной частотой проходит через голосовой тракт, который из-за своей формы обладает определенным фильтрующими характеристиками. Но многие характеристики гортанного источника не важны для различения разных фонем. Вместо этого наиболее полезной информацией является фильтр, то есть точное расположение голосового тракта. Если бы мы знали форму голосового тракта, мы бы знали, какая фонема произносится. Это наводит на мысль, что полезные функции для распознавания телефоном позволили бы найти способ деконволюции(разделения) источника и фильтра и показать нам только фильтр голосового тракта. Оказывается, кепструм - один из способов это сделать.

![[Pasted image 20251227191225.png]]

Для простоты давайте рассмотрим в качестве входных данных логарифмический спектр амплитуд и проигнорируем масштабирование Мела. Кепстр можно рассматривать как спектр логарифма спектра. Это может показаться запутанным. Но давайте начнем с простой части: логарифма спектра. То есть, кепстр начинается со стандартного спектра амплитуд, например, спектра для гласного звука, показанного на рисунке выше с буквой (а). Затем мы берем логарифм, то есть заменяем каждое значение амплитуды в спектре амплитуд его логарифмом, как показано на рисунке выше (б).

Следующий шаг - визуализировать логарифмический спектр, как если бы он сам был формой волны. Другими словами, рассмотрим логарифмический спектр на рисунке выше (б). Представим, что удалим метки осей, которые указывают на то, что это спектр, и представим, что мы имеем дело с обычным речевым сигналом, где по оси $x$ отложено время. Что же теперь можно сказать о спектре этого "псевдосигнала"? Обратите внимание, что в этой волне присутствует высокочастотная повторяющаяся составляющая: небольшие волны, которые повторяются примерно 8 раз на каждые 1000 отсчетов вдоль оси $x$, с частотой около 120 Гц. Эта высокочастотная составляющая обусловлена основной частотой сигнала и представляет собой небольшие пики в спектре на каждой гармонике сигнала. Кроме того, в этом "псевдосигнале" присутствуют некоторые низкочастотные составляющие; например, огибающая или формантная структура имеет около четырех больших пиков в окне, для гораздо более низкой частоты. 

На рисунке выше (с) показан кепстр: спектр, который мы описывали, логарифмического спектра. Этот кепстр показан с отсчетами вдоль оси $x$. Это происходит потому, что, взяв спектр логарифмического спектра, мы вышли за пределы частотной области и вернулись во временную область. Оказывается, правильной единицей измерения кепстра является отсчет.

Рассматривая этот кепстр, мы видим, что действительно имеется большой пик около 120, соответствующий F0 и представляющий собой голосовой импульс. Есть и другие различные компоненты, расположенные на более низких значениях по оси $x$. Они представляют собой фильтр голового тракта. Таким образом, если нас интересует обнаружение фонем, мы можем использовать только нижние значения кепстра. Если нас интересует обнаружение высоты тона, мы можем использовать верхние значения кепстра. Для целей извлечения MFCC мы обычно берем только первые 12 значений кепстра. Эти 12 коэффициентов будут представлять информацию исключительно о фильтре голосового тракта, четко отделенную от информации о голосовом источнике.

Оказывается, кепстральные коэффициенты обладают чрезвычайно полезным свойством: дисперсия различных коэффициентов, как правило, некоррелирована. Это не относится к спектру, где спектральные коэффициенты в разных частотных диапазонах коррелированы. Для тех, кто знаком с обработкой сигналов, кепстр более формально определяется как обратное DFT логарифма модуля DFT сигнала; следовательно. для оконного кадра речи $x[n]$,
$$
c[n]=\sum_{n=0}^{N-1}\log\left( |\sum_{n=0}^{N-1} x[n]e^{ -j \frac{2\pi}{N}kn }| \right) e^{ j \frac{2\pi}{N}kn }
$$
**Энергия** К 12 кепстральным коэффициентов из предыдущего раздела мы добавляем 13-ю характеристику: *энергию кадра*. Энергия является полезным признаком для обнаружения фонем. *Энергия в кадре* - это сумма за время мощности отсчетов в кадре; таким образом, для сигнала $x$ в окне от временного отсчета $t_{1}$ до временного отсчета $t_{2}$ энергии равна:
$$
\mathrm{Energy} = \sum_{t=t_{1}}^{t_{2}}x^{2}[t]
$$
**Дельта-признаки** Мы также добавляем признаки, связанные с изменением кепстрального характеристик во времени. Изменения в речевом сигнале, такие как наклон форманты в точках перехода или переход от смыкания стоп-сигнала к взрыву стоп-сигнала, могут снова служить полезным ориентиром для идентификации фонем. К каждому из 13 признаков (12 кепстральных характеристик плюс энергия) добавляется дельта-признак или признак ускорения. Каждый из 13 дельта-признаков представляющий собой изменение между кадрами в соответствующих дельта-признаках. Эти дельты можно просто вычислить, вычитая значения в кадре из предыдущего значения, но на практике обычно аппроксимируют полиномом и берут его первую и вторую производные.