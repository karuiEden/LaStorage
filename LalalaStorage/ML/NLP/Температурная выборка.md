---
title: Температурная выборка
created: 2025-11-16
tags:
  - nlp
links:
  - "[[Случайное сэмплирование]]"
---
Идея температурной выборки заключается в изменении распределения вероятности таким образом, чтобы увеличить вероятности высоковероятных токенов и уменьшить вероятности низковероятных токенов. В результате, модель меньше генерирует низковероятных токенов и больше высоковероятных токенов.

Мы имплементируем эту идею просто делением логитов на *параметр температуры* $\tau$ перед тем, как передадим это в $\text{softmax}$. В низкотемпературной выборке $\tau \in(0,1]$. В высокотемпературной выборке $\tau >1$.
$$
y=\text{softmax}(u / \tau)
$$
![[Pasted image 20251116182711.png]]

В зависимости от коэффициента выборка могла уходить в жадный декодинг, если коэффициент стремится к нулю, а при увеличении стремится к равновероятному распределению.

![[Pasted image 20251116183331.png]]
