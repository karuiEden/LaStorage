	Здесь предоставлена информация для работы с данными в ML
### Работа с NaN или пустыми элементами

В некоторых признаках будут встречаться пропуски. Необходимо решить, что с ними делать. Можно просто удалить их, но когда у нас мало данных, то удалить мы не можем. Тогда мы можем заполнить их какими-либо значениями. Обычно для этого используют **моду**, **медиану** и **среднее**:

- **Мода** - значение изменяемого признака, которое встречается наиболее часто;
- **Медиана** - значение признака, которое делит упорядоченное множество данных пополам;
- **Среднее** - среднее арифметическое.

Если распределение симметрично, унимодально(имеет только одну моду) и не имеет значительных выбросов, то использовать мы можем любое значение из 3, так как они все будут примерно равны. Если же распределение ассиметрично и имеет значительные выбросы, то лучше всего использовать **моду** или **медиану**.

### Создание новых признаков

При анализе данных иногда приходится создавать новые признаки, но зачем?
1.  Создание новых признаков помогает обучению модели. Это происходит, если некоторые признаки крайне похожи, поэтому их объединение может дать пользу. Также. если несколько признаков в данных сильно скоррелированы, то это вредит обучению модели, поэтому их объединение помогает ей обучаться.
2. Объединение признаков также понижает затраты на вычислительную мощность, так как модель будет смотреть на меньшее количество признаков.
3. Объединение признаков может помочь лучше интерпритировать результаты.

### Типы признаков

При исследовании и сборе данных очень важно знать, какого рода данные вы получаете, чтобы их можно было хорошо интерпретировать и анализировать. Чаще всего в исследованиях используются два типа данных:

- Категориальные данные
- Количественные (Числовые) данные

**Категориальные данные** — это данные с ограниченным числом уникальных значений или категорий. Примеры таких типов данных — пол, семейное положение, уровень образования и т.п. Категориальные поля могут быть текстовыми или числовыми, в которых категории закодированы числовыми кодами (например, 0 = Женский, а 1 = Мужской). Также иногда эти данные называются качественными данными.

Существуют следующие виды категориальных данных:

- Набор. Поле/переменная, значения которого представляют категории без естественного упорядочивания (например, подразделение компании, в котором работает сотрудник). Примеры таких переменных — регион, почтовый индекс или религия. Также иногда такой тип называют номинальной переменной.
- Упорядоченный набор. Это поле/переменная, на значениях которых есть естественный порядок. Это могут быть, например, уровни удовлетворенности обслуживанием (от крайней неудовлетворенности до полной удовлетворенности), уровень образования (от базового школьного до доктора наук). Также такой тип переменной называют порядковой переменной.
- Флаг. Поле или переменная с двумя отдельными значениями. Например, Да и Нет, 1 и 2. Также известны также как дихотомические или двоичные переменные.

**Количественные (числовые) данные** — это данные, для элементов которых определены порядок значений и расстояния между значениями. Пример признака такого типа — зарплата. Зарплата 7195 рублей больше зарплаты 5398 рублей, а разница между этими зарплатами - 1797 рублей. Такие данные также называют непрерывными или числовым диапазоном.

## Обработка категориальных признаков

Существует два базовых способа обработки данных признаков:
1. One-hot Encoding.
2.  Label Encoding.

### One-hot Encoding

![[Pasted image 20240927100802.png]]

**One Hot Encoding** является одним из самым распространённым способом обработки категориальных данных.

Работает он так: пусть у какого-то категориального признака есть $n$ значений: $A_1, A_2, ..., A_n$ . Тогда для каждого $A_i$ будет создан столбец-признак, который имеет только два значения 0 или 1(данный признаки будут бинарными). Тогда если признак имеет значение $A_i$ , то значение в столбце $A_i$ будет равно 1, а в остальных - 0.

Хорошая иллюстрация данного способа показана выше.

Данный способ можно использовать при помощи библиотеки [[Pandas#One Hot Encoding|Pandas]] и  [[Sklearn#One hot Encoding|Sklearn]].

### Label Encoding

![[Pasted image 20240927105625.png]]

**Label encoding** - это более простой способ обработать категориальные признаки. Он работает по принципу перевода категориальных данных в численные(показано выше), что очень похоже на перечисления(`Enum`)

Но данный способ имеет недостаток, так как значений уже может быть $n$, то модель при обучении может обнаружить некую закономерность, что приведёт к неудовлетворительным результатам, так как изначально данной закономерности никогда не существовало.

Пример использования показывается на библиотеке [[Sklearn#Label Encoding |Sklearn]].

## Корреляция

**Корреляция** - мера линейной зависимости признаков друг от друга. Сильно скоррелированные признаки могут оказать негативный эффект на обучение линейной модели. Если в дата сете такие признаки есть, то необходимо от них избавляться. Делать это нужно данными способами:
1. Оставляя один из признаков
2. Соединив признак в один и создав новый признак
3. Сделать нелинейное преобразование признаков.

![[Pasted image 20240927113644.png]]

Изучить корреляцию можно при помощи матрицы корреляции, её можно создать с помощью библиотек [[Pandas#Матрица корреляции |Pandas]] и [[Seaborn#Матрица корреляций|Seaborn]].

По результатам изучения корреляции можно сделать выводы:
1. Если есть сильная корреляция между целевой переменной и признаком, то это хорошо, так как видна зависимость.
2. Плохо, если она есть между обычными признаками.

## Анализ влияния признаков на целевую переменную

Мы должны понять, какие признаки влияют на целевую переменную, а какие нет, чтобы затем удалить ненужные признаки.

### Боксплоты

![[Pasted image 20240927125730.png]]

Это вид диаграммы, который находится выше. Он состоит из **квантилей распределения**. Однако, что же такое **квантиль**? **Квантиль** это такое значение признака, которое делит упорядоченные данные на части. А **квантили распределения** делят на равные части упорядоченные данные. Рассмотрим их подробнее:
![[Pasted image 20240927130037.png]]

![[Pasted image 20240927130101.png]]