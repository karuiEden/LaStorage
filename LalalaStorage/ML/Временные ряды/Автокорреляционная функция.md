---
title: Автокорреляционная функция
created: 2025-10-07
tags:
  - ml
  - time_series
links:
  - "[[Временные ряды]]"
---

В качестве оценки корреляции значений $y_{t}$ и $y_{t+\tau}$ для любых $t$ рассмотрим коэффициент корреляции Пирсона ряда с самим собой со сдвигом на $\tau$. Тем самым получим численную оценку степени влияния $y_{t}$ на $y_{t+\tau}$:
>[!definition] Функция автокорреляции
>$$r_{\tau}=\widehat{corr}(y_{t},y_{t+\tau})= \frac{\sum_{t=1}^{T-\tau}(y_{t}-\overline{y})(y_{t+\tau}-\overline{y})}{\sum_{t=1}^{T}(y_{t}-\overline{y})^{2}},$$
> где $\tau$ - лаг автокорреляции, а $\overline{y}=\sum_{t=1}^{T}y_{t}$ - среднее.

>[!remark] Формула содержит некоторые упрощения при оценке ковариации и среднего

**Свойства коэффициента корреляции**:
- $|r_{\tau}|\leq1$
- $r_{\tau}=0$ - отсутствие автокорреляции, при этом значения могут быть зависимыми.
- $r_{\tau}>0$ - положительная корреляция, т.е. чем больше значение было вчера, тем больше будет сегодня.
- $r_{\tau}<0$ - отрицательная корреляция, т.е. чем больше было значение вчера, тем меньше будет сегодня.
- $|r_{\tau}|=1$ - строгая линейная зависимость.

Для проверки значимости $r_{\tau}$ можно использовать статистический критерий Льюнга-Бокса, который проверяет значимость отклонения $r_{\tau}$ от нуля. Основное правило, если значение p-value критерия не превосходит $0.05$ (или другого заранее зафиксированного порога значимости), то автокорреляция лага $\tau$ значима.


Рассмотрим временной ряд ДТП за 14 лет с дискретностью в 1 месяц. На графике мы видим явную сезонность На нижнем графике изображена *коррелограмма*.
>[!definition] Коррелограмма
>График, визуализирующий автокорреляционную функцию.

Её значение в нуле всегда равно единице, так как корреляция считается с одним и тем же объектом. Также мы видим, что $r_{12}$ является локальным максимумом, что означает высокую положительную корреляцию значения ряда за текущий месяц с аналогичным значением за прошлый год. Наоборот, в $r_{6}$ видим, что она является локальным минимумом, что означает высокую отрицательную корреляцию. Закрашенная область визуализирует границу незначимой автокорреляции, то есть тех значений автокорреляции, для которых не выявлена статистическая значимое отличие от $0$. 
Также мы видим, что последнее значимое значение $r_{24}$, а также 2 несезонных показателя $r_{1}$ и $r_{2}$.
Из чего можно сделать вывод, что для построения прогноза $y_{t}$ имеет смысл рассматривать признаки $y_{t-1},y_{t-2},y_{t-6},y_{t-12}$ и $y_{t-24}$.
![[ex_1_6fd71c0161_ef125825e0.webp]]

![[ex_1_autocorr_77d8a02254_20f571b267.webp]]



