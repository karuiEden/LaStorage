---
title: Методы стрижки дерева
created: 2025-10-01
tags:
  - ml
  - decision_tree
links:
  - "[[Решающие деревья]]"
---
Стрижка дерева является альтернативой критериям останова. То есть сначала мы строим переобученное дерево, а затем производится оптимизация его структуры с целью улучшения обобщающей способности. Существует ряд исследований, показывающих, что стрижка позволяет достичь лучшего качества по сравнению с ранним остановом построения дерева на основе различных критериев.
При этом, методы стрижки редко используются, ибо само по себе дерево является слабым алгоритмом, а для композиций: для случайного леса нужны переобученные деревья, а для бустинга - небольшой длины, поэтому необходимость в стрижке отпадает.

Рассмотрим один из методов стрижки под названием *cost-complexity pruning*. Обозначим дерево, полученное в результате работы жадного алгоритма, через $T_{0}$. Поскольку в каждом из листьев находятся объекты только одного класса, значение $R(T)$ будет минимально на самом дереве $T_{0}$(среди всех поддеревьев). Однако данный функционал характеризует качество дерева лишь на обучающей выборке, и чрезмерная подгонка под неё лишь увеличит переобучение. Чтобы преодолеть эту проблему, введем новый функционал $R_{\alpha}(T)$, представляющий собой сумму исходного функционала $R(T)$ и штрафа за размер дерева: $$R_{\alpha}(T)=T(T)+\alpha|T|,$$
где $|T|$ - число листьев в поддереве $T$, а $\alpha\geq 0$ - параметр. Это один из примеров *регуляризованных* критериев качества, которые ищут баланс между качеством классификации обучающей выборки и сложностью построенной модели.
Можно показать, что сущетсвуте последовательность вложенных деревьев с одинаковыми корнями: $$T_{K}\subset T_{K-1}\subset\dots \subset T_{0},$$
(здесь $T_{K}$ тривиальное дерево, состоящее из корня дерева $T_{0}$), в которой каждое дерево $T_{i}$ минимизирует критерий $R_{\alpha}(T)$ для $\alpha \in[\alpha_{i},\alpha_{i+1})$, причем  $$0=\alpha_{0}<\alpha_{1}<\dots<\alpha_{K}<\infty$$
Эту последовательность можно достаточно эффективно найти путем обхода дерева. Далее из неё выбирается оптимальное дерево по отложенной выборке или с помощью кросс-валидации.