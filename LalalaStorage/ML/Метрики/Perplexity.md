---
title: Perplexity
created: 2025-11-11
tags:
  - nlp
  - ml
  - metric
links:
---
**Определение:** *Перплексия(Perplexity)* - метрика языковых моделей, которая показывает степень неопределённости модели.
$$
\text{perplexity}(W) = \sqrt[N]{ \frac{1}{P(w_{1}w_{2}\dots w_{N})}  }= \sqrt[n]{ \prod_{i=1}^{N} \frac{1}{P(w_{i}\ | \ w_{1}\dots w_{i-1})} }
$$
Вычисление этой метрики зависит от языковой модели, которую мы тестируем.
Чем меньше метрика, тем лучше модель, идеальная модель имеет значение $1$.

Для модели $\theta$ на неизвестном тестовом наборе перплексия равна:
$$
\text{perplexity}_{\theta} = \sqrt[n]{ \frac{1}{P_{\theta}(w_{1:n})} }=\sqrt[n]{ \prod_{i=1}^{n} \frac{1}{P_{\theta}(w_{i}\ | \ w_{<i})} }
$$
Но необходимо помнить, что перплексия зависит от количества токенов, поэтому она довольно чувствительна от разности алгоритма токенизации.