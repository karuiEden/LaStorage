---
title: Категориальные данные
created: 2025-09-16
tags:
  - ml
links:
---
Допустим, в выборке имеется категориальный признак, значение которого на объекте $x$ обозначим через $f(x)$. Будем считать, что она будет принимать значения из множества $U=\{ u_{1},\dots,u_{n} \}$. Чтобы использовать категориальные признаки в линейных моделях, необходимо закодировать их.

## Бинарное кодирование (one-hot encoding)

Простейший способ кодирования - создать $n$ индикаторов, каждый из них которых будет отвечать за одно из значений категориального признака. Иначе, мы создаём $n$ бинарных признаков $g_{1}(x),\dots,g_{n}(x)$, которые определяются как:
$$g_{j}(x)=[f(x)=u_{j}]$$
Проблема этого подхода заключается в том, что если категориальный признак состоит из огромного множества значений, то после кодирования появится огромное количество новых признаков. Линейные модели хорошо работают с этим, так как имеют небольшое количество параметров и за счёт лёгкого обучения.
## Бинарное кодирование с хэшированием

Есть модификация бинарного кодирования, которая ускоряет процесс вычисления признаков. Выберем хэш-функцию $h:U\to \{ 1,2,\dots B ,\}$, которая переводит значения признака в числа от $1$ до $B$. $$g_{j}(x)=[h(f(x))=j], \ j=1,\dots,B$$
Основное преимущество данной модификации, что при ней отпадает необходимость в хранении соответствий между значениями категориального признака и индексами бинарных признаков .Также она позволяет сократить количество признаков, если $|U|>B$.

## Счётчики


