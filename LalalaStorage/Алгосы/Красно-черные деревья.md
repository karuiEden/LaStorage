---
title: Красно-черные деревья
created: 2025-06-12
tags:
  - dsa
links:
  - "[[Бинарные деревья поиска]]"
---
**Определение:** Красно-чёрное дерево - это бинарное дерево поиска с дополнительными полями:
```c
struct Node{
	int key;
	int color;
	struct Node *left, *right;
	struct Node *parent;
};
```

Также вместо проверок листьев на `NULL` используется указатель на внешний лист `EList`
![[Pasted image 20250612194157.png]]

И обладает следующими свойствами:
1. Каждый узел является красным или чёрным;
2. Корень является черным.
3. Каждый лист дерева, является чёрным.
4. Если узел красный, то оба его дочерних узла - черные
5. Для каждого узла все пути от него до листьев, являющихся потомками данного узла, содержат одно и то же количество черных узлов
**Определение:** Количество черных узлов на пути от узла $x$ к некоторому листу называется черной высотой листа $x$.

Черной высотой дерева является черная высота его корня.

Красно-черное дерево с $n$ внутренними узлами имеет высоту $h$ не более $$h \leq 2\log(n+1)$$
Черная высота должна составлять как минимум $\frac{h}{2}$
**Операции:**
- Поиск - $O(\log n)$
- Вставка - $O(\log n)$
- Удаление - $O(\log n)$

## Повороты
### Левый поворот

![[Pasted image 20250612203245.png]]

```c
void left_rotate(RBTree t, Node* x){
	y = x->right;
	p = x->parent;
	x->right = y->left;
	if (y->left != EList){
		y->left->parent = x;
	}
	y->parent = p;
	if (p == EList){
		t.root = y;
	} else {
		if (p->left == x){
			p->left = y;
		} else {
			p->right = y;
		}
	}
	y->left = x;
	x->parent = y;
}
```

Время выполнения $O(1)$ 
## Вставка

**Алгоритм:** 
1. Вставить узел $x$ как в обычное BST
2. Полям $left,right$ присвоить значение EList
3. Окрасить новый узел в красный цвет;
4. Перекрасить узлы и выполнить повороты.
После вставки может быть нарушено:
- Корень - чёрный;
- Если узел красный, то его потомки чёрные.

### Востановление свойств
Случай 1:

![[Pasted image 20250612205625.png]]

![[Pasted image 20250612205807.png]]


![[Pasted image 20250612205831.png]]
![[Pasted image 20250612205844.png]]

## Удаление

*Алгоритм:*
- Удалить узел как в бинарном дереве;
- Учесть представление листьев;
- Восстановить красно-чёрные свойства.
