---
title: Просматриваемая таблица со сборщиком мусора. Вектор
created: 2025-06-09
tags:
  - dsa
links:
  - "[[Просматриваемая таблица]]"
  - "[[Вектор]]"
---
## Вид
![[Pasted image 20250609184359.png]]

## Удаление

```c
int erase(Table t, int key){
	if (t.csize == 0){
		return err;
	}
	int i = search(t, key);
	if (i == -1){
		return err;
	}
	t.data[i].busy = 0;
	return OK; 
}
```

Вместо замены элемента идёт просто изменение поля `busy`.
## Поиск

```c
int search(Table t, int key){
	if (t.csize == 0){
		return err;
	}
	for (int i = 0; i < t.mize; ++i){
		if(t.data[i].busy == 1 &&  t.data[i].key == key){
			return i;
		}
	}
	return -1;
}
```

Помимо учёта равенства ключей мы учитываем поле `busy`.

## Вставка

По умолчанию,  таблица не имеет дублирования ключей.

```c
int insert(Table t, int key, Info* info){
	if(search(t, key) != -1){
		return err;
	}
	if (t.csize == t.msize){
		garbage_collector(t);
		if (t.csize == t.msize){
			return err;
		}
	}
	t.data[t.csize].key = key;
	t.data[t.csize].info = info;
	return OK;
}
```

### Сборщик мусора
![[Pasted image 20250609185428.png]]

```c
void garbage_collector(Table t){
	if (t.csize == 0){
		return;
	}
	int i = 0;
	int j = 0;
	while (i < t.csize){
		if (t.data[i].busy == 1){
			t.data[j] = t.data[i];
			++j;
		}
		++i;
	}
	t.csize = j;
}
```
